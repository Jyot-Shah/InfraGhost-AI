<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>InfraGhost AI</title>
    <link rel="stylesheet" href="/css/main.css" />
    <link rel="stylesheet" href="/css/index-styles.css" />
  </head>
  <body>
    <!-- Full Screen Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay hidden">
      <div class="loading-content fade-in">
        <div class="spinner"></div>
        <h3>Analyzing Infrastructure...</h3>
        <p>Our AI is examining your photo to verify the infrastructure reality. This may take a few moments.</p>
        <div class="loading-dots mt-3">
          <span></span>
          <span></span>
          <span></span>
        </div>
      </div>
    </div>

    <!-- Navigation -->
    <nav>
      <div style="max-width: 1200px; margin: 0 auto; padding: 16px 24px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 16px;">
        <div style="display: flex; align-items: center; gap: 12px;">
          <span style="font-size: 2rem;">üëª</span>
          <h1 style="color: var(--beige); font-size: 1.5rem; margin: 0; white-space: nowrap;">InfraGhost AI</h1>
        </div>
        <div style="display: flex; gap: 12px; flex-wrap: wrap; justify-content: flex-end;">
          <a href="/" class="active">Submit Report</a>
          <a href="/map.html">Map View</a>
          <a href="/authority.html">Authority Summary</a>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <div style="max-width: 1200px; margin: 0 auto; padding: 40px 24px;">
      <!-- Hero Section -->
      <div id="heroSection" class="hero fade-in">
        <div class="ghost-icon">üëª</div>
        <h2>Verify Infrastructure Reality</h2>
        <p>
          Help us identify InfraGhosts ‚Äî assets that exist on paper but not in reality. 
          Upload photos and feedback to build a truthful map of public infrastructure.
        </p>
      </div>

      <!-- Success Message -->
      <div id="successMessage" class="hidden">
        <div class="card result-card slide-up">
          <button id="closeSuccess" class="close-btn" title="Close">√ó</button>
          
          <div style="text-align: center; margin-bottom: 20px;">
            <div style="font-size: 3rem;">‚úÖ</div>
            <h3 style="color: var(--success); font-size: 1.8rem; margin-top: 10px;">Report Submitted Successfully!</h3>
          </div>

          <div class="status-indicator">
            <span class="status-icon">üèóÔ∏è</span>
            <span><strong>Infrastructure Present:</strong> <span id="existsValue"></span></span>
          </div>

          <div class="status-indicator">
            <span class="status-icon">‚úì</span>
            <span><strong>Usable:</strong> <span id="usableValue"></span></span>
          </div>

          <div class="analysis-text">
            <strong style="color: var(--dark-teal); font-size: 1.1rem;">AI Analysis:</strong>
            <p id="reasonValue" style="margin-top: 10px; color: var(--ink-black); line-height: 1.6;"></p>
          </div>

          <div class="score-display">
            <div class="score-box">
              <div class="score-label">Usability Score</div>
              <div id="usabilityValue" class="score-value" style="color: var(--air-force-blue);"></div>
              <div style="font-size: 0.8rem; color: #666;">out of 100</div>
            </div>
            <div class="score-box">
              <div class="score-label">Ghost Score</div>
              <div id="ghostScoreValue" class="score-value"></div>
              <div style="font-size: 0.8rem; color: #666;">out of 100</div>
            </div>
          </div>

          <div style="text-align: center; margin-top: 30px;">
            <p style="font-size: 0.9rem; color: var(--dark-teal); font-weight: 600; margin-bottom: 10px;">CLASSIFICATION</p>
            <div id="ghostLevelValue" class="status-badge"></div>
          </div>
        </div>
      </div>

      <!-- Submission Form -->
      <div id="formSection" class="form-container">

        <!-- Error Message -->
        <div id="errorMessage" class="hidden">
          <div class="alert alert-error slide-in">
            <span style="font-size: 1.5rem;">‚ö†Ô∏è</span>
            <div>
              <strong>Error</strong>
              <p id="errorText" style="margin-top: 4px;"></p>
            </div>
          </div>
        </div>

        <!-- Form Card -->
        <div class="card fade-in">
          <form id="reportForm" class="form-group">
            <!-- Infrastructure Type -->
            <div>
              <label for="infraType">Infrastructure Type *</label>
              <select id="infraType" name="infraType" required>
                <option value="">Select infrastructure type</option>
                <option value="water">üö∞ Drinking Water</option>
                <option value="toilet">üöΩ Toilet</option>
                <option value="streetlight">üí° Streetlight</option>
                <option value="ramp">‚ôø Ramp</option>
              </select>
            </div>

            <!-- Image Upload -->
            <div>
              <label>Upload Photo *</label>
              <div id="imageDropZone" class="drop-zone">
                <input
                  type="file"
                  id="imageInput"
                  name="image"
                  accept="image/*"
                  required
                  style="display: none;"
                />
                <span id="imageLabel" style="color: var(--air-force-blue); font-size: 1.1rem;">
                  üì∏ Click to upload or drag and drop<br />
                  <span style="font-size: 0.9rem; color: var(--ash-grey);">JPG, PNG up to 10MB</span>
                </span>
                <img
                  id="imagePreview"
                  src=""
                  alt="Preview"
                  class="hidden"
                />
              </div>
            </div>

            <!-- Feedback -->
            <div>
              <label for="comment">What's the actual condition?</label>
              <input
                type="text"
                id="comment"
                name="comment"
                maxlength="100"
                placeholder="E.g., Tap installed but no water flow"
              />
              <div id="charCount" class="char-counter">0/100 characters</div>
            </div>

            <!-- Location Status -->
            <div>
              <label>Location (Auto-detected)</label>
              <div id="locationStatus" class="location-box">
                üìç Detecting location...
              </div>
            </div>

            <!-- Submit Button -->
            <button type="submit" id="submitBtn" class="btn btn-primary" style="font-size: 1.1rem; padding: 16px;">
              <span id="btnText">üì§ Submit Infrastructure Report</span>
            </button>
          </form>
        </div>
      </div>

      <!-- Info Section -->
      <div id="infoSection" class="info-container">
        <div class="info-grid">
          <div class="info-card fade-in">
            <h3>What We Check</h3>
            <p>
              Our AI analyzes your photo to verify if infrastructure is actually usable, 
              not just present on paper.
            </p>
          </div>
          <div class="info-card fade-in" style="animation-delay: 0.1s;">
            <h3>Ghost Score</h3>
            <p>
              Score 0-100. High scores mean it's an InfraGhost 
              (exists but unusable).
            </p>
          </div>
          <div class="info-card fade-in" style="animation-delay: 0.2s;">
            <h3>See the Map</h3>
            <p>
              All reports are mapped. Authorities can use the summary for action.
            </p>
          </div>
        </div>
      </div>
      
      <!-- Map Link (shown after submission) -->
      <div id="mapLinkSection" class="hidden" style="text-align: center; margin-top: 40px;">
        <div class="info-card fade-in" style="max-width: 400px; margin: 0 auto;">
          <h3>üó∫Ô∏è See the Map</h3>
          <p>
            All reports are mapped. View the interactive map to see InfraGhosts in your area.
          </p>
          <a href="/map.html" class="btn btn-primary" style="display: inline-block; margin-top: 16px; text-decoration: none;">
            üìç View Infrastructure Map
          </a>
        </div>
      </div>
    </div>

    <script type="module" src="/js/index.js"></script>
  </body>
</html>
